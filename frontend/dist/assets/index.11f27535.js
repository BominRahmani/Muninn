(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();function p(e){return window.go.main.App.SaveNote(e)}const a=document.getElementById("capturePopup"),c=document.getElementById("textInput"),l=document.getElementById("attachmentsSection"),u=document.getElementById("fileInput"),h=document.getElementById("pastedIndicator");let r=[];c.addEventListener("input",function(){this.style.height="auto",this.style.height=Math.max(120,this.scrollHeight)+"px"});a.addEventListener("dragover",e=>{e.preventDefault(),a.classList.add("drag-over")});a.addEventListener("dragleave",e=>{a.contains(e.relatedTarget)||a.classList.remove("drag-over")});a.addEventListener("drop",e=>{e.preventDefault(),a.classList.remove("drag-over");const t=Array.from(e.dataTransfer.files);m(t)});document.addEventListener("paste",e=>{const t=e.clipboardData.items,s=[];for(let i of t)i.kind==="file"&&s.push(i.getAsFile());s.length>0&&(m(s),L())});u.addEventListener("change",e=>{const t=Array.from(e.target.files);m(t),u.value=""});function g(){u.click()}function m(e){e.forEach(t=>{const s={id:Date.now()+Math.random(),name:t.name,file:t,type:t.type};r.push(s)}),f()}function v(e){r=r.filter(t=>t.id!==e),f()}function f(){if(r.length===0){l.classList.remove("has-attachments"),l.innerHTML="";return}l.classList.add("has-attachments"),l.innerHTML=r.map(e=>`
        <div class="attachment-item">
            <div class="attachment-icon">${y(e.type)}</div>
            <div class="attachment-name">${e.name}</div>
            <button class="attachment-remove" onclick="removeAttachment(${e.id})">\xD7</button>
        </div>
    `).join("")}function y(e){return e.startsWith("image/")?"\u{1F5BC}\uFE0F":e.includes("pdf")?"\u{1F4C4}":e.includes("text")?"\u{1F4DD}":"\u{1F4CE}"}function L(){h.classList.add("show"),setTimeout(()=>{h.classList.remove("show")},2e3)}async function E(){const e=c.value.trim();if(!(!e&&r.length===0))try{const t=r.map(i=>({fileName:i.name,fileType:i.type,filePath:"",data:null})),s={text:e,attachments:t,timestamp:new Date};p(s),c.value="",c.style.height="120px",r=[],f(),console.log("Note saved successfully")}catch(t){console.error("Error saving note:",t)}}document.addEventListener("keydown",e=>{e.key==="Escape"&&console.log("Closing capture popup..."),e.ctrlKey&&e.key==="Enter"&&(e.preventDefault(),E())});window.triggerFileSelect=g;window.removeAttachment=v;setTimeout(()=>c.focus(),100);
