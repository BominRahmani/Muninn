(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();function h(e){return window.go.main.App.SaveNote(e)}function g(){window.runtime.Hide()}const a=document.getElementById("capturePopup"),c=document.getElementById("textInput"),l=document.getElementById("attachmentsSection"),u=document.getElementById("fileInput"),p=document.getElementById("pastedIndicator");let i=[];c.addEventListener("input",function(){this.style.height="auto",this.style.height=Math.max(120,this.scrollHeight)+"px"});a.addEventListener("dragover",e=>{e.preventDefault(),a.classList.add("drag-over")});a.addEventListener("dragleave",e=>{a.contains(e.relatedTarget)||a.classList.remove("drag-over")});a.addEventListener("drop",e=>{e.preventDefault(),a.classList.remove("drag-over");const t=Array.from(e.dataTransfer.files);m(t)});document.addEventListener("paste",e=>{const t=e.clipboardData.items,o=[];for(let r of t)r.kind==="file"&&o.push(r.getAsFile());o.length>0&&(m(o),E())});u.addEventListener("change",e=>{const t=Array.from(e.target.files);m(t),u.value=""});function v(){u.click()}function m(e){e.forEach(t=>{const o={id:Date.now()+Math.random(),name:t.name,file:t,type:t.type};i.push(o)}),f()}function y(e){i=i.filter(t=>t.id!==e),f()}function f(){if(i.length===0){l.classList.remove("has-attachments"),l.innerHTML="";return}l.classList.add("has-attachments"),l.innerHTML=i.map(e=>`
        <div class="attachment-item">
            <div class="attachment-icon">${L(e.type)}</div>
            <div class="attachment-name">${e.name}</div>
            <button class="attachment-remove" onclick="removeAttachment(${e.id})">\xD7</button>
        </div>
    `).join("")}function L(e){return e.startsWith("image/")?"\u{1F5BC}\uFE0F":e.includes("pdf")?"\u{1F4C4}":e.includes("text")?"\u{1F4DD}":"\u{1F4CE}"}function E(){p.classList.add("show"),setTimeout(()=>{p.classList.remove("show")},2e3)}async function I(){const e=c.value.trim();if(!e&&i.length===0)return;const t=document.getElementById("capturePopup");t.classList.add("screen-vibrate"),setTimeout(()=>{t.classList.remove("screen-vibrate")},300);try{const o=i.map(n=>({fileName:n.name,fileType:n.type,filePath:"",data:null})),r={Text:e,Attachments:o,Timestamp:new Date};h(r),c.value="",c.style.height="120px",i=[],f(),console.log("Note saved successfully")}catch(o){console.error("Error saving note:",o)}}document.addEventListener("keydown",e=>{e.key==="Escape"&&(console.log("Closing capture popup..."),g()),e.ctrlKey&&e.key==="Enter"&&(e.preventDefault(),I())});window.triggerFileSelect=v;window.removeAttachment=y;setTimeout(()=>c.focus(),100);
